# PaperTapeReaderCar

紙テープを読んでそこに書いてある指令通りに走る車

<img src="./doc/PXL_20231008_222416077.jpg" width=512 />
裏側
<img src="./doc/PXL_20231008_222529692.jpg" width=512 />
底面
<img src="./doc/PXL_20231008_223644795.jpg" width=512 />

### 構成図

<img src="./doc/Diagram.svg" width=512 />

紙テープリーダーと全体制御のPicoとそれに付属したモータードライバーとモーター３個からなる。
モバイルバッテリーからUSBハブで紙テープリーダー、Pico、モータードライバーの３か所に電源を供給している。
紙テープリーダーのTX出力はPico側のUART0に通信ケーブルで接続されている。RXはつないでないので
紙テープリーダーが一方的にテープ読み出し用光センサーの値を送ってくるだけである。

電源ONと同時に紙テープリーダーが通信を開始し、遅れてPico側が通信ポートをオープンすると、
かなりの頻度で同期がズレて文字化けを起こすので、文字化けすると再オープンする処理が入っている。


紙テープリーダーは以下のもの。テストモードの出力がTXから送信されるようにソフトウェアに若干手が入っている。

https://www.e-basteln.de/computing/papertape/building/


picoモータードライバーの資料

https://www.waveshare.com/wiki/Pico-Motor-Driver

ソース一覧

||ファイル名|
|--|--|
|picoソース|main.py|
|紙テープリーダー修正ソース|sketch_oct4a.ino|

もともとはEV3で紙テープ読みながら走るクルマを作りたかったので、EV3に関するドキュメントは以下にある。

[EV3について](./EV3/README.md)

以下、読まなくていいグチ

　もともとはLEGO Mindstorms EV3に紙テープリーダーを接続してMakerFairで走らせたいという話だったので、続いてpicoの代わりにEV3を使うことをやりはじめた。ケーブル作ればなんとかなるっしょ、くらいの簡単なお仕事と思ってたら、意外に難しかった。

1. LEGO本社からMindstormsの製品ページがなくなっている。
2. BricsCCというLEGO Mindstroms界隈でよく使われてる開発環境を入れようしたら、SygwinだのGitだのEV3のソースだのいろいろ必要で、最終的にクロスコンパイラが配布終了になっているのが分かってお手上げ。
3. EV3のOS (なんとLinux) を置き換えて、Micropythonを使って開発できる環境がVS Code の拡張機能にあるのでインストール。picoのMicropythonではUARTオブジェクトでシリアル通信できたから、EV3のMicropythonにそれらしきオブジェクトがないかダンプしてみたが出力にでてこない。
4. 私の作ったPythonのオブジェクトダンプは、importしないと対象が出てこないものだった。UART関連オブジェクト名をマニュアル見てimportしたらちゃんと出力された。
